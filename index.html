<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Royal Point</title>

  <!-- Bootstrap / FontAwesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- LIFF & html5-qrcode -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>

  <link rel="stylesheet" href="/style.css">
</head>
<body class="bg-app">

<div class="container px-3 py-3">
  <!-- Header -->
  <div class="header-card shadow-soft">
    <div class="d-flex align-items-center gap-3">
      <img id="profilePic" src="https://placehold.co/56x56" class="rounded-circle border border-2 border-dark-subtle" width="56" height="56" alt="">
      <div class="flex-grow-1">
        <div class="d-flex align-items-center gap-2">
          <h5 id="username" class="mb-0">—</h5>
          <span id="tierBadge" class="badge badge-tier tier-silver">ระดับ Silver</span>
        </div>
        <div class="text-secondary small mt-1">
          <span id="userMeta">— | —</span>
        </div>
      </div>
      <div class="text-end">
        <div class="text-warning fw-bold"><i class="fa-solid fa-coins"></i></div>
        <div id="points" class="fs-4">0</div>
        <div class="small text-secondary">Pt</div>
      </div>
    </div>

    <!-- Progress half-circle -->
    <div class="mt-3">
      <svg viewBox="0 0 100 50" class="w-100">
        <path d="M 10 50 A 40 40 0 0 1 90 50" stroke="#1b2740" stroke-width="10" fill="none"/>
        <path id="progressCurve" d="M 10 50 A 40 40 0 0 1 90 50"
              stroke="#39d2c0" stroke-width="10" fill="none"
              stroke-dasharray="126" stroke-dashoffset="126" stroke-linecap="round"/>
      </svg>
      <div id="tier-label" class="text-center fw-semibold mt-2">ระดับ Silver</div>
      <p id="next-tier" class="text-center text-secondary small mt-1">สะสมอีก <b>100</b> พ้อยท์ ภายใน <b>31/12/68</b> เพื่อเลื่อนเป็น <b>Gold</b></p>
    </div>

    <div class="d-flex gap-2 mt-2">
      <button class="btn btn-primary flex-grow-1" data-bs-toggle="modal" data-bs-target="#scoreModal">
        <i class="fa-solid fa-qrcode"></i> สแกนคิวอาร์โค้ดรับพ้อยท์
      </button>
      <button id="btnRefresh" class="btn btn-ghost"><i class="fa-solid fa-rotate"></i></button>
      <a id="btnAdmin" href="/admin.html" class="btn btn-ghost d-none"><i class="fa-solid fa-shield-halved"></i></a>
    </div>
  </div>

  <!-- Registration -->
  <div id="regSection" class="card card-pane mt-3 d-none">
    <h5 class="mb-3">ระบบลงทะเบียนใช้งาน</h5>
    <form id="regForm" class="row g-3">
      <input type="hidden" id="uid" name="uid" />
      <div class="col-12">
        <label class="form-label">ชื่อ - นามสกุล</label>
        <input id="name" name="name" class="form-control" required/>
      </div>
      <div class="col-12">
        <label class="form-label">Section</label>
        <select id="room" name="room" class="form-select" required>
          <option value="" disabled selected>เลือก</option>
          <option value="ACC">ACC</option><option value="C&FA">C&FA</option>
          <option value="CS">CS</option><option value="CIC">CIC</option>
          <option value="DIR">DIR</option><option value="ENG">ENG</option>
          <option value="FIN">FIN</option><option value="GR">GR</option>
          <option value="HP">HP</option><option value="HCM">HCM</option>
          <option value="HRD">HRD</option><option value="HRM">HRM</option>
          <option value="IT">IT</option><option value="L&S">L&S</option>
          <option value="MTN">MTN</option><option value="MKT">MKT</option>
          <option value="MC">MC</option><option value="OS">OS</option>
          <option value="PD">PD</option><option value="PD1">PD1</option>
          <option value="PD2">PD2</option><option value="PC">PC</option>
          <option value="PE">PE</option><option value="PUR">PUR</option>
          <option value="QA">QA</option><option value="QC">QC</option>
          <option value="RDPP">RDPP</option><option value="R&D">R&D</option>
          <option value="SHE">SHE</option><option value="SCM">SCM</option>
          <option value="SYS-ENG">SYS-ENG</option><option value="TSH CENTER">TSH CENTER</option>
          <option value="WH">WH</option>
        </select>
      </div>
      <div class="col-6">
        <label class="form-label">วันเกิด</label>
        <input id="dob" name="dob" type="date" class="form-control" required/>
      </div>
      <div class="col-6">
        <label class="form-label">เลขประจำตัวพนักงาน/Passport</label>
        <input id="passport" name="passport" class="form-control" required/>
      </div>
      <div class="col-12">
        <label class="form-label">เบอร์โทรศัพท์</label>
        <input id="telephone" name="telephone" class="form-control" required/>
      </div>
      <div class="col-12">
        <button class="btn btn-primary w-100" type="submit">สมัครใช้งาน</button>
      </div>
    </form>
  </div>

  <!-- Ads (optional) -->
  <div class="mt-3">
    <div id="carouselAdsControls" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner rounded-4 overflow-hidden">
        <div class="carousel-item active"><img src="https://lh3.googleusercontent.com/d/1j6_CKghy0tLKW2dJW7W1E8TLMKxMtJTl" class="d-block w-100"></div>
        <div class="carousel-item"><img src="https://lh3.googleusercontent.com/d/1SJkRqfgv8r5D_r0_z-GXCI464oLxhgkc" class="d-block w-100"></div>
        <div class="carousel-item"><img src="https://lh3.googleusercontent.com/d/16N6b_e-IcwKSX2HTGqj16mVBClGOpsHy" class="d-block w-100"></div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselAdsControls" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
        <span class="visually-hidden">ก่อนหน้า</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselAdsControls" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
        <span class="visually-hidden">ถัดไป</span>
      </button>
    </div>
  </div>
</div>

<!-- Modal: รับคะแนน -->
<div class="modal fade" id="scoreModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen-sm-down">
    <div class="modal-content modal-dark">
      <div class="modal-header">
        <h5 class="modal-title"><i class="fa-solid fa-qrcode me-2"></i>เพิ่มคะแนนสะสม</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        <div id="qr-reader" style="width:100%;max-width:380px;margin:auto;"></div>
        <hr class="my-4">
        <div class="form-group">
          <label class="form-label">หรือกรอกรหัสลับเพื่อรับคะแนน</label>
          <div class="input-group">
            <input id="secretCode" class="form-control text-center" placeholder="กรอกรหัสลับ">
            <button id="btnManualRedeem" class="btn btn-success"><i class="fa-solid fa-check"></i> ยืนยัน</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<footer class="text-center text-secondary small py-4">
  © <script>document.write(new Date().getFullYear());</script> Royal Point
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="/app.js?v=5"></script>
</body>
</html>
